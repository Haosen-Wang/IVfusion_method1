Epoch 1/5:   1%|▍                                                                     | 48/8100 [00:58<10:07, 13.26it/s]
当前学习率: 0.001000
⚠️  批次 20 检测到 NaN/Inf 损失，跳过此批次...
损失详情: {'total_loss_f': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'pixel_loss': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'gradient_loss': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'perceptual_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'total_loss_vi': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'rec_i': tensor(nan, device='cuda:2', grad_fn=<MseLossBackward0>), 'rec_g': tensor(nan, device='cuda:2', grad_fn=<MseLossBackward0>), 'kl_loss_i': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'kl_loss_g': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'total_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>)}
⚠️  批次 21 内存不足，跳过...
⚠️  批次 22 内存不足，跳过...
⚠️  批次 23 内存不足，跳过...
⚠️  批次 24 内存不足，跳过...
⚠️  批次 25 内存不足，跳过...
⚠️  批次 26 内存不足，跳过...
⚠️  批次 27 内存不足，跳过...
⚠️  批次 28 内存不足，跳过...
⚠️  批次 29 内存不足，跳过...
⚠️  批次 30 内存不足，跳过...
⚠️  批次 31 内存不足，跳过...
⚠️  批次 32 内存不足，跳过...
⚠️  批次 33 内存不足，跳过...
⚠️  批次 34 内存不足，跳过...
⚠️  批次 35 内存不足，跳过...
⚠️  批次 36 内存不足，跳过...
⚠️  批次 37 内存不足，跳过...
⚠️  批次 38 内存不足，跳过...
⚠️  批次 39 内存不足，跳过...
⚠️  批次 40 内存不足，跳过...
⚠️  批次 41 内存不足，跳过...
⚠️  批次 42 内存不足，跳过...
⚠️  批次 43 内存不足，跳过...
⚠️  批次 44 内存不足，跳过...
⚠️  批次 45 内存不足，跳过...
⚠️  批次 46 内存不足，跳过...
⚠️  批次 47 内存不足，跳过...
⚠️  批次 48 内存不足，跳过...
⚠️  批次 49 内存不足，跳过...
⚠️  批次 50 内存不足，跳过...
⚠️  批次 51 内存不足，跳过...
⚠️  批次 52 内存不足，跳过...
⚠️  批次 53 内存不足，跳过...
⚠️  批次 54 内存不足，跳过...
⚠️  批次 55 内存不足，跳过...
⚠️  批次 56 内存不足，跳过...
⚠️  批次 57 内存不足，跳过...
⚠️  批次 58 内存不足，跳过...
⚠️  批次 59 内存不足，跳过...
⚠️  批次 60 内存不足，跳过...
⚠️  批次 61 内存不足，跳过...
⚠️  批次 62 内存不足，跳过...
⚠️  批次 63 内存不足，跳过...
⚠️  批次 64 内存不足，跳过...
⚠️  批次 65 内存不足，跳过...
⚠️  批次 66 内存不足，跳过...
⚠️  批次 67 内存不足，跳过...
⚠️  批次 68 内存不足，跳过...
⚠️  批次 69 内存不足，跳过...
⚠️  批次 70 内存不足，跳过...
⚠️  批次 71 内存不足，跳过...
⚠️  批次 72 内存不足，跳过...
⚠️  批次 73 内存不足，跳过...
⚠️  批次 74 内存不足，跳过...
⚠️  批次 75 内存不足，跳过...
⚠️  批次 76 内存不足，跳过...
⚠️  批次 77 内存不足，跳过...
⚠️  批次 78 内存不足，跳过...
⚠️  批次 79 内存不足，跳过...
⚠️  批次 80 内存不足，跳过...
⚠️  批次 81 内存不足，跳过...
⚠️  批次 82 内存不足，跳过...
⚠️  批次 83 内存不足，跳过...
⚠️  批次 84 内存不足，跳过...
⚠️  批次 85 内存不足，跳过...
⚠️  批次 86 内存不足，跳过...
⚠️  批次 87 内存不足，跳过...
⚠️  批次 88 内存不足，跳过...
⚠️  批次 89 内存不足，跳过...
⚠️  批次 90 内存不足，跳过...
⚠️  批次 91 内存不足，跳过...
⚠️  批次 92 内存不足，跳过...
⚠️  批次 93 内存不足，跳过...
⚠️  批次 94 内存不足，跳过...
⚠️  批次 95 内存不足，跳过...
⚠️  批次 96 内存不足，跳过...
⚠️  批次 97 内存不足，跳过...
⚠️  批次 98 内存不足，跳过...
⚠️  批次 99 内存不足，跳过...
⚠️  批次 100 内存不足，跳过...
⚠️  批次 101 内存不足，跳过...
⚠️  批次 102 内存不足，跳过...
⚠️  批次 103 内存不足，跳过...
⚠️  批次 104 内存不足，跳过...
⚠️  批次 105 内存不足，跳过...
⚠️  批次 106 内存不足，跳过...
⚠️  批次 107 内存不足，跳过...
⚠️  批次 108 内存不足，跳过...
⚠️  批次 109 内存不足，跳过...
⚠️  批次 110 内存不足，跳过...
⚠️  批次 111 内存不足，跳过...
⚠️  批次 112 内存不足，跳过...
⚠️  批次 113 内存不足，跳过...
⚠️  批次 114 内存不足，跳过...
⚠️  批次 115 内存不足，跳过...
⚠️  批次 116 内存不足，跳过...
⚠️  批次 117 内存不足，跳过...
⚠️  批次 118 内存不足，跳过...
⚠️  批次 119 内存不足，跳过...
⚠️  批次 120 内存不足，跳过...
⚠️  批次 121 内存不足，跳过...
⚠️  批次 122 内存不足，跳过...
⚠️  批次 123 内存不足，跳过...
⚠️  批次 124 内存不足，跳过...
⚠️  批次 125 内存不足，跳过...
⚠️  批次 126 内存不足，跳过...
⚠️  批次 127 内存不足，跳过...
⚠️  批次 128 内存不足，跳过...
⚠️  批次 129 内存不足，跳过...
⚠️  批次 130 内存不足，跳过...
⚠️  批次 131 内存不足，跳过...
⚠️  批次 132 内存不足，跳过...
⚠️  批次 133 内存不足，跳过...
⚠️  批次 134 内存不足，跳过...
⚠️  批次 135 内存不足，跳过...
⚠️  批次 136 内存不足，跳过...
⚠️  批次 137 内存不足，跳过...
⚠️  批次 138 内存不足，跳过...
⚠️  批次 139 内存不足，跳过...
⚠️  批次 140 内存不足，跳过...
⚠️  批次 141 内存不足，跳过...
⚠️  批次 142 内存不足，跳过...
⚠️  批次 143 内存不足，跳过...
⚠️  批次 144 内存不足，跳过...
⚠️  批次 145 内存不足，跳过...
⚠️  批次 146 内存不足，跳过...
⚠️  批次 147 内存不足，跳过...
⚠️  批次 148 内存不足，跳过...
⚠️  批次 149 内存不足，跳过...
⚠️  批次 150 内存不足，跳过...
⚠️  批次 151 内存不足，跳过...
⚠️  批次 152 内存不足，跳过...
⚠️  批次 153 内存不足，跳过...
⚠️  批次 154 内存不足，跳过...
⚠️  批次 155 内存不足，跳过...
⚠️  批次 156 内存不足，跳过...
⚠️  批次 157 内存不足，跳过...
⚠️  批次 158 内存不足，跳过...
⚠️  批次 159 内存不足，跳过...
⚠️  批次 160 内存不足，跳过...
⚠️  批次 161 内存不足，跳过...
⚠️  批次 162 内存不足，跳过...
⚠️  批次 163 内存不足，跳过...
⚠️  批次 164 内存不足，跳过...
⚠️  批次 165 内存不足，跳过...
⚠️  批次 166 内存不足，跳过...
⚠️  批次 167 内存不足，跳过...
⚠️  批次 168 内存不足，跳过...
⚠️  批次 169 内存不足，跳过...
⚠️  批次 170 内存不足，跳过...
⚠️  批次 171 内存不足，跳过...
⚠️  批次 172 内存不足，跳过...
⚠️  批次 173 内存不足，跳过...
⚠️  批次 174 内存不足，跳过...
⚠️  批次 175 内存不足，跳过...
⚠️  批次 176 内存不足，跳过...
⚠️  批次 177 内存不足，跳过...
⚠️  批次 178 内存不足，跳过...
⚠️  批次 179 内存不足，跳过...
⚠️  批次 180 内存不足，跳过...
⚠️  批次 181 内存不足，跳过...
⚠️  批次 182 内存不足，跳过...
⚠️  批次 183 内存不足，跳过...
⚠️  批次 184 内存不足，跳过...
⚠️  批次 185 内存不足，跳过...
⚠️  批次 186 内存不足，跳过...
⚠️  批次 187 内存不足，跳过...
⚠️  批次 188 内存不足，跳过...
⚠️  批次 189 内存不足，跳过...
⚠️  批次 190 内存不足，跳过...
⚠️  批次 191 内存不足，跳过...
⚠️  批次 192 内存不足，跳过...
⚠️  批次 193 内存不足，跳过...
⚠️  批次 194 内存不足，跳过...
⚠️  批次 195 内存不足，跳过...
⚠️  批次 196 内存不足，跳过...
⚠️  批次 197 内存不足，跳过...
⚠️  批次 198 内存不足，跳过...
⚠️  批次 199 内存不足，跳过...
⚠️  批次 200 内存不足，跳过...
⚠️  批次 201 内存不足，跳过...
⚠️  批次 202 内存不足，跳过...
⚠️  批次 203 内存不足，跳过...
⚠️  批次 204 内存不足，跳过...
⚠️  批次 205 内存不足，跳过...
⚠️  批次 206 内存不足，跳过...
⚠️  批次 207 内存不足，跳过...
⚠️  批次 208 内存不足，跳过...
⚠️  批次 209 内存不足，跳过...
⚠️  批次 210 内存不足，跳过...
⚠️  批次 211 内存不足，跳过...
⚠️  批次 212 内存不足，跳过...
⚠️  批次 213 内存不足，跳过...
⚠️  批次 214 内存不足，跳过...
⚠️  批次 215 内存不足，跳过...
⚠️  批次 216 内存不足，跳过...
⚠️  批次 217 内存不足，跳过...
⚠️  批次 218 内存不足，跳过...
⚠️  批次 219 内存不足，跳过...
⚠️  批次 220 内存不足，跳过...
⚠️  批次 221 内存不足，跳过...
⚠️  批次 222 内存不足，跳过...
⚠️  批次 223 内存不足，跳过...
⚠️  批次 224 内存不足，跳过...
⚠️  批次 225 内存不足，跳过...
⚠️  批次 226 内存不足，跳过...
⚠️  批次 227 内存不足，跳过...
⚠️  批次 228 内存不足，跳过...
⚠️  批次 229 内存不足，跳过...
⚠️  批次 230 内存不足，跳过...
⚠️  批次 231 内存不足，跳过...
⚠️  批次 232 内存不足，跳过...
⚠️  批次 233 内存不足，跳过...
⚠️  批次 234 内存不足，跳过...
⚠️  批次 235 内存不足，跳过...
⚠️  批次 236 内存不足，跳过...
⚠️  批次 237 内存不足，跳过...
⚠️  批次 238 内存不足，跳过...
⚠️  批次 239 内存不足，跳过...
⚠️  批次 240 内存不足，跳过...
⚠️  批次 241 内存不足，跳过...
⚠️  批次 242 内存不足，跳过...
⚠️  批次 243 内存不足，跳过...
⚠️  批次 244 内存不足，跳过...
⚠️  批次 245 内存不足，跳过...
⚠️  批次 246 内存不足，跳过...
⚠️  批次 247 内存不足，跳过...
⚠️  批次 248 内存不足，跳过...
⚠️  批次 249 内存不足，跳过...
⚠️  批次 250 内存不足，跳过...
⚠️  批次 251 内存不足，跳过...
⚠️  批次 252 内存不足，跳过...
⚠️  批次 253 内存不足，跳过...
⚠️  批次 254 内存不足，跳过...
⚠️  批次 255 内存不足，跳过...
⚠️  批次 256 内存不足，跳过...
⚠️  批次 257 内存不足，跳过...
⚠️  批次 258 内存不足，跳过...
⚠️  批次 259 内存不足，跳过...
⚠️  批次 260 内存不足，跳过...
⚠️  批次 261 内存不足，跳过...
⚠️  批次 262 内存不足，跳过...
⚠️  批次 263 内存不足，跳过...
⚠️  批次 264 内存不足，跳过...
⚠️  批次 265 内存不足，跳过...
⚠️  批次 266 内存不足，跳过...
⚠️  批次 267 内存不足，跳过...
⚠️  批次 268 内存不足，跳过...
⚠️  批次 269 内存不足，跳过...
⚠️  批次 270 内存不足，跳过...
⚠️  批次 271 内存不足，跳过...
⚠️  批次 272 内存不足，跳过...
⚠️  批次 273 内存不足，跳过...
⚠️  批次 274 内存不足，跳过...
⚠️  批次 275 内存不足，跳过...
⚠️  批次 276 内存不足，跳过...
⚠️  批次 277 内存不足，跳过...
⚠️  批次 278 内存不足，跳过...
⚠️  批次 279 内存不足，跳过...
⚠️  批次 280 内存不足，跳过...
⚠️  批次 281 内存不足，跳过...
⚠️  批次 282 内存不足，跳过...
⚠️  批次 283 内存不足，跳过...
⚠️  批次 284 内存不足，跳过...
⚠️  批次 285 内存不足，跳过...
⚠️  批次 286 内存不足，跳过...
⚠️  批次 287 内存不足，跳过...
⚠️  批次 288 内存不足，跳过...
⚠️  批次 289 内存不足，跳过...
⚠️  批次 290 内存不足，跳过...
⚠️  批次 291 内存不足，跳过...
⚠️  批次 292 内存不足，跳过...
⚠️  批次 293 内存不足，跳过...
⚠️  批次 294 内存不足，跳过...
⚠️  批次 295 内存不足，跳过...
⚠️  批次 296 内存不足，跳过...
⚠️  批次 297 内存不足，跳过...
⚠️  批次 298 内存不足，跳过...
⚠️  批次 299 内存不足，跳过...
⚠️  批次 300 内存不足，跳过...
⚠️  批次 301 内存不足，跳过...
⚠️  批次 302 内存不足，跳过...
⚠️  批次 303 内存不足，跳过...
⚠️  批次 304 内存不足，跳过...
⚠️  批次 305 内存不足，跳过...
⚠️  批次 306 内存不足，跳过...
⚠️  批次 307 内存不足，跳过...
⚠️  批次 308 内存不足，跳过...
⚠️  批次 309 内存不足，跳过...
⚠️  批次 310 内存不足，跳过...
⚠️  批次 311 内存不足，跳过...
⚠️  批次 312 内存不足，跳过...
⚠️  批次 313 内存不足，跳过...
⚠️  批次 314 内存不足，跳过...
⚠️  批次 315 内存不足，跳过...
⚠️  批次 316 内存不足，跳过...
⚠️  批次 317 内存不足，跳过...
⚠️  批次 318 内存不足，跳过...
⚠️  批次 319 内存不足，跳过...
⚠️  批次 320 内存不足，跳过...
⚠️  批次 321 内存不足，跳过...
⚠️  批次 322 内存不足，跳过...
⚠️  批次 323 内存不足，跳过...
⚠️  批次 324 内存不足，跳过...
⚠️  批次 325 内存不足，跳过...
⚠️  批次 326 内存不足，跳过...
⚠️  批次 327 内存不足，跳过...
⚠️  批次 328 内存不足，跳过...
⚠️  批次 329 内存不足，跳过...
⚠️  批次 330 内存不足，跳过...
⚠️  批次 331 内存不足，跳过...
⚠️  批次 332 内存不足，跳过...
⚠️  批次 333 内存不足，跳过...
⚠️  批次 334 内存不足，跳过...
⚠️  批次 335 内存不足，跳过...
⚠️  批次 336 内存不足，跳过...
⚠️  批次 337 内存不足，跳过...
⚠️  批次 338 内存不足，跳过...
⚠️  批次 339 内存不足，跳过...
⚠️  批次 340 内存不足，跳过...
⚠️  批次 341 内存不足，跳过...
⚠️  批次 342 内存不足，跳过...
⚠️  批次 343 内存不足，跳过...
⚠️  批次 344 内存不足，跳过...
⚠️  批次 345 内存不足，跳过...
⚠️  批次 346 内存不足，跳过...
⚠️  批次 347 内存不足，跳过...
⚠️  批次 348 内存不足，跳过...
⚠️  批次 349 内存不足，跳过...
⚠️  批次 350 内存不足，跳过...
⚠️  批次 351 内存不足，跳过...
⚠️  批次 352 内存不足，跳过...
⚠️  批次 353 内存不足，跳过...
⚠️  批次 354 内存不足，跳过...
⚠️  批次 355 内存不足，跳过...
⚠️  批次 356 内存不足，跳过...
⚠️  批次 357 内存不足，跳过...
⚠️  批次 358 内存不足，跳过...
⚠️  批次 359 内存不足，跳过...
⚠️  批次 360 内存不足，跳过...
⚠️  批次 361 内存不足，跳过...
⚠️  批次 362 内存不足，跳过...
⚠️  批次 363 内存不足，跳过...
⚠️  批次 364 内存不足，跳过...
⚠️  批次 365 内存不足，跳过...
⚠️  批次 366 内存不足，跳过...
⚠️  批次 367 内存不足，跳过...
⚠️  批次 368 内存不足，跳过...
⚠️  批次 369 内存不足，跳过...
⚠️  批次 370 内存不足，跳过...
⚠️  批次 371 内存不足，跳过...
⚠️  批次 372 内存不足，跳过...
⚠️  批次 373 内存不足，跳过...
⚠️  批次 374 内存不足，跳过...
⚠️  批次 375 内存不足，跳过...
⚠️  批次 376 内存不足，跳过...
⚠️  批次 377 内存不足，跳过...
⚠️  批次 378 内存不足，跳过...
⚠️  批次 379 内存不足，跳过...
⚠️  批次 380 内存不足，跳过...
⚠️  批次 381 内存不足，跳过...
⚠️  批次 382 内存不足，跳过...
⚠️  批次 383 内存不足，跳过...
⚠️  批次 384 内存不足，跳过...
⚠️  批次 385 内存不足，跳过...
⚠️  批次 386 内存不足，跳过...
⚠️  批次 387 内存不足，跳过...
⚠️  批次 388 内存不足，跳过...
⚠️  批次 389 内存不足，跳过...
⚠️  批次 390 内存不足，跳过...
⚠️  批次 391 内存不足，跳过...
⚠️  批次 392 内存不足，跳过...
⚠️  批次 393 内存不足，跳过...
⚠️  批次 394 内存不足，跳过...
⚠️  批次 395 内存不足，跳过...
⚠️  批次 396 内存不足，跳过...
⚠️  批次 397 内存不足，跳过...
⚠️  批次 398 内存不足，跳过...
⚠️  批次 399 内存不足，跳过...
⚠️  批次 400 内存不足，跳过...
⚠️  批次 401 内存不足，跳过...
⚠️  批次 402 内存不足，跳过...
⚠️  批次 403 内存不足，跳过...
⚠️  批次 404 内存不足，跳过...
⚠️  批次 405 内存不足，跳过...
⚠️  批次 406 内存不足，跳过...
⚠️  批次 407 内存不足，跳过...
⚠️  批次 408 内存不足，跳过...
⚠️  批次 409 内存不足，跳过...
⚠️  批次 410 内存不足，跳过...
⚠️  批次 411 内存不足，跳过...
⚠️  批次 412 内存不足，跳过...
⚠️  批次 413 内存不足，跳过...
⚠️  批次 414 内存不足，跳过...
⚠️  批次 415 内存不足，跳过...
⚠️  批次 416 内存不足，跳过...
⚠️  批次 417 内存不足，跳过...
⚠️  批次 418 内存不足，跳过...
⚠️  批次 419 内存不足，跳过...
⚠️  批次 420 内存不足，跳过...
⚠️  批次 421 内存不足，跳过...
⚠️  批次 422 内存不足，跳过...
⚠️  批次 423 内存不足，跳过...
⚠️  批次 424 内存不足，跳过...
⚠️  批次 425 内存不足，跳过...
⚠️  批次 426 内存不足，跳过...
⚠️  批次 427 内存不足，跳过...
⚠️  批次 428 内存不足，跳过...
⚠️  批次 429 内存不足，跳过...
⚠️  批次 430 内存不足，跳过...
⚠️  批次 431 内存不足，跳过...
⚠️  批次 432 内存不足，跳过...
⚠️  批次 433 内存不足，跳过...
⚠️  批次 434 内存不足，跳过...
⚠️  批次 435 内存不足，跳过...
⚠️  批次 436 内存不足，跳过...
⚠️  批次 437 内存不足，跳过...
⚠️  批次 438 内存不足，跳过...
⚠️  批次 439 内存不足，跳过...
⚠️  批次 440 内存不足，跳过...
⚠️  批次 441 内存不足，跳过...
⚠️  批次 442 内存不足，跳过...
⚠️  批次 443 内存不足，跳过...
⚠️  批次 444 内存不足，跳过...
Traceback (most recent call last):
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 420, in <module>
    main(**config_dic)
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 383, in main
    best_epoch, best_loss = train_model(
                            ^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 137, in train_model
    epoch_loss = train_epoch_model(model, train_loader, criterion, optimizer, device_1, device_2, device_3, val_loader, pbar)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 39, in train_epoch_model
    output, l, g, mu_l, sigma2_l, mu_g, sigma2_g = model(i_image, v_image, device_1, device_2, device_3)
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/model.py", line 44, in forward
    l,mu_l,sigma2_l = self.I_encoder_decoder(i)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/model.py", line 17, in forward
    x=self.encoder(x)
      ^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/component.py", line 19, in forward
    x=self.model(x)
      ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/../restormer/restormer_arch.py", line 248, in forward
    out_enc_level3 = self.encoder_level3(inp_enc_level3)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/../restormer/restormer_arch.py", line 142, in forward
    x = x + self.ffn(self.norm2(x))
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/../restormer/restormer_arch.py", line 86, in forward
    x = self.project_out(x)
        ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
           ^^^^^^^^^
KeyboardInterrupt
