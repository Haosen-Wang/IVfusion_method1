Epoch 1/5:   6%|████▍                                                                  | 56/904 [01:22<01:05, 12.95it/s]
当前学习率: 0.001000
⚠️  批次 28 检测到 NaN/Inf 损失，跳过此批次...
损失详情: {'total_loss_f': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'pixel_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'gradient_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'perceptual_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'total_loss_vi': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'rec_i': tensor(nan, device='cuda:2', grad_fn=<MseLossBackward0>), 'rec_g': tensor(nan, device='cuda:2', grad_fn=<MseLossBackward0>), 'kl_loss_i': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'kl_loss_g': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'total_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>)}
⚠️  批次 29 内存不足，跳过...
⚠️  批次 30 内存不足，跳过...
⚠️  批次 31 内存不足，跳过...
⚠️  批次 32 内存不足，跳过...
⚠️  批次 33 内存不足，跳过...
⚠️  批次 34 内存不足，跳过...
⚠️  批次 35 内存不足，跳过...
⚠️  批次 36 内存不足，跳过...
⚠️  批次 37 内存不足，跳过...
⚠️  批次 38 内存不足，跳过...
⚠️  批次 39 内存不足，跳过...
⚠️  批次 40 内存不足，跳过...
⚠️  批次 41 内存不足，跳过...
⚠️  批次 42 内存不足，跳过...
⚠️  批次 43 内存不足，跳过...
⚠️  批次 44 内存不足，跳过...
⚠️  批次 45 内存不足，跳过...
⚠️  批次 46 内存不足，跳过...
⚠️  批次 47 内存不足，跳过...
⚠️  批次 48 内存不足，跳过...
⚠️  批次 49 内存不足，跳过...
⚠️  批次 50 内存不足，跳过...
⚠️  批次 51 内存不足，跳过...
⚠️  批次 52 内存不足，跳过...
⚠️  批次 53 内存不足，跳过...
⚠️  批次 54 内存不足，跳过...
⚠️  批次 55 内存不足，跳过...
⚠️  批次 56 内存不足，跳过...
⚠️  批次 57 内存不足，跳过...
⚠️  批次 58 内存不足，跳过...
⚠️  批次 59 内存不足，跳过...
⚠️  批次 60 内存不足，跳过...
⚠️  批次 61 内存不足，跳过...
⚠️  批次 62 内存不足，跳过...
⚠️  批次 63 内存不足，跳过...
⚠️  批次 64 内存不足，跳过...
⚠️  批次 65 内存不足，跳过...
⚠️  批次 66 内存不足，跳过...
⚠️  批次 67 内存不足，跳过...
⚠️  批次 68 内存不足，跳过...
⚠️  批次 69 内存不足，跳过...
⚠️  批次 70 内存不足，跳过...
⚠️  批次 71 内存不足，跳过...
⚠️  批次 72 内存不足，跳过...
⚠️  批次 73 内存不足，跳过...
⚠️  批次 74 内存不足，跳过...
⚠️  批次 75 内存不足，跳过...
⚠️  批次 76 内存不足，跳过...
⚠️  批次 77 内存不足，跳过...
⚠️  批次 78 内存不足，跳过...
⚠️  批次 79 内存不足，跳过...
⚠️  批次 80 内存不足，跳过...
⚠️  批次 81 内存不足，跳过...
⚠️  批次 82 内存不足，跳过...
⚠️  批次 83 内存不足，跳过...
⚠️  批次 84 内存不足，跳过...
⚠️  批次 85 内存不足，跳过...
⚠️  批次 86 内存不足，跳过...
⚠️  批次 87 内存不足，跳过...
⚠️  批次 88 内存不足，跳过...
⚠️  批次 89 内存不足，跳过...
⚠️  批次 90 内存不足，跳过...
⚠️  批次 91 内存不足，跳过...
⚠️  批次 92 内存不足，跳过...
⚠️  批次 93 内存不足，跳过...
⚠️  批次 94 内存不足，跳过...
⚠️  批次 95 内存不足，跳过...
⚠️  批次 96 内存不足，跳过...
⚠️  批次 97 内存不足，跳过...
⚠️  批次 98 内存不足，跳过...
⚠️  批次 99 内存不足，跳过...
⚠️  批次 100 内存不足，跳过...
⚠️  批次 101 内存不足，跳过...
⚠️  批次 102 内存不足，跳过...
⚠️  批次 103 内存不足，跳过...
⚠️  批次 104 内存不足，跳过...
⚠️  批次 105 内存不足，跳过...
⚠️  批次 106 内存不足，跳过...
⚠️  批次 107 内存不足，跳过...
⚠️  批次 108 内存不足，跳过...
⚠️  批次 109 内存不足，跳过...
⚠️  批次 110 内存不足，跳过...
⚠️  批次 111 内存不足，跳过...
⚠️  批次 112 内存不足，跳过...
⚠️  批次 113 内存不足，跳过...
⚠️  批次 114 内存不足，跳过...
⚠️  批次 115 内存不足，跳过...
⚠️  批次 116 内存不足，跳过...
⚠️  批次 117 内存不足，跳过...
⚠️  批次 118 内存不足，跳过...
⚠️  批次 119 内存不足，跳过...
⚠️  批次 120 内存不足，跳过...
⚠️  批次 121 内存不足，跳过...
⚠️  批次 122 内存不足，跳过...
⚠️  批次 123 内存不足，跳过...
⚠️  批次 124 内存不足，跳过...
⚠️  批次 125 内存不足，跳过...
⚠️  批次 126 内存不足，跳过...
⚠️  批次 127 内存不足，跳过...
⚠️  批次 128 内存不足，跳过...
⚠️  批次 129 内存不足，跳过...
⚠️  批次 130 内存不足，跳过...
⚠️  批次 131 内存不足，跳过...
⚠️  批次 132 内存不足，跳过...
⚠️  批次 133 内存不足，跳过...
⚠️  批次 134 内存不足，跳过...
⚠️  批次 135 内存不足，跳过...
⚠️  批次 136 内存不足，跳过...
⚠️  批次 137 内存不足，跳过...
⚠️  批次 138 内存不足，跳过...
⚠️  批次 139 内存不足，跳过...
⚠️  批次 140 内存不足，跳过...
⚠️  批次 141 内存不足，跳过...
⚠️  批次 142 内存不足，跳过...
⚠️  批次 143 内存不足，跳过...
⚠️  批次 144 内存不足，跳过...
⚠️  批次 145 内存不足，跳过...
⚠️  批次 146 内存不足，跳过...
⚠️  批次 147 内存不足，跳过...
⚠️  批次 148 内存不足，跳过...
⚠️  批次 149 内存不足，跳过...
⚠️  批次 150 内存不足，跳过...
⚠️  批次 151 内存不足，跳过...
⚠️  批次 152 内存不足，跳过...
⚠️  批次 153 内存不足，跳过...
⚠️  批次 154 内存不足，跳过...
⚠️  批次 155 内存不足，跳过...
⚠️  批次 156 内存不足，跳过...
⚠️  批次 157 内存不足，跳过...
⚠️  批次 158 内存不足，跳过...
⚠️  批次 159 内存不足，跳过...
⚠️  批次 160 内存不足，跳过...
⚠️  批次 161 内存不足，跳过...
⚠️  批次 162 内存不足，跳过...
⚠️  批次 163 内存不足，跳过...
⚠️  批次 164 内存不足，跳过...
⚠️  批次 165 内存不足，跳过...
⚠️  批次 166 内存不足，跳过...
⚠️  批次 167 内存不足，跳过...
⚠️  批次 168 内存不足，跳过...
⚠️  批次 169 内存不足，跳过...
⚠️  批次 170 内存不足，跳过...
⚠️  批次 171 内存不足，跳过...
⚠️  批次 172 内存不足，跳过...
⚠️  批次 173 内存不足，跳过...
⚠️  批次 174 内存不足，跳过...
⚠️  批次 175 内存不足，跳过...
⚠️  批次 176 内存不足，跳过...
⚠️  批次 177 内存不足，跳过...
⚠️  批次 178 内存不足，跳过...
⚠️  批次 179 内存不足，跳过...
⚠️  批次 180 内存不足，跳过...
⚠️  批次 181 内存不足，跳过...
⚠️  批次 182 内存不足，跳过...
⚠️  批次 183 内存不足，跳过...
⚠️  批次 184 内存不足，跳过...
⚠️  批次 185 内存不足，跳过...
⚠️  批次 186 内存不足，跳过...
⚠️  批次 187 内存不足，跳过...
⚠️  批次 188 内存不足，跳过...
⚠️  批次 189 内存不足，跳过...
⚠️  批次 190 内存不足，跳过...
⚠️  批次 191 内存不足，跳过...
⚠️  批次 192 内存不足，跳过...
⚠️  批次 193 内存不足，跳过...
⚠️  批次 194 内存不足，跳过...
⚠️  批次 195 内存不足，跳过...
⚠️  批次 196 内存不足，跳过...
⚠️  批次 197 内存不足，跳过...
⚠️  批次 198 内存不足，跳过...
⚠️  批次 199 内存不足，跳过...
⚠️  批次 200 内存不足，跳过...
⚠️  批次 201 内存不足，跳过...
⚠️  批次 202 内存不足，跳过...
⚠️  批次 203 内存不足，跳过...
⚠️  批次 204 内存不足，跳过...
⚠️  批次 205 内存不足，跳过...
⚠️  批次 206 内存不足，跳过...
⚠️  批次 207 内存不足，跳过...
⚠️  批次 208 内存不足，跳过...
⚠️  批次 209 内存不足，跳过...
⚠️  批次 210 内存不足，跳过...
⚠️  批次 211 内存不足，跳过...
⚠️  批次 212 内存不足，跳过...
⚠️  批次 213 内存不足，跳过...
⚠️  批次 214 内存不足，跳过...
⚠️  批次 215 内存不足，跳过...
⚠️  批次 216 内存不足，跳过...
⚠️  批次 217 内存不足，跳过...
⚠️  批次 218 内存不足，跳过...
⚠️  批次 219 内存不足，跳过...
⚠️  批次 220 内存不足，跳过...
⚠️  批次 221 内存不足，跳过...
⚠️  批次 222 内存不足，跳过...
⚠️  批次 223 内存不足，跳过...
⚠️  批次 224 内存不足，跳过...
⚠️  批次 225 内存不足，跳过...
⚠️  批次 226 内存不足，跳过...
⚠️  批次 227 内存不足，跳过...
⚠️  批次 228 内存不足，跳过...
⚠️  批次 229 内存不足，跳过...
⚠️  批次 230 内存不足，跳过...
⚠️  批次 231 内存不足，跳过...
⚠️  批次 232 内存不足，跳过...
⚠️  批次 233 内存不足，跳过...
⚠️  批次 234 内存不足，跳过...
⚠️  批次 235 内存不足，跳过...
⚠️  批次 236 内存不足，跳过...
⚠️  批次 237 内存不足，跳过...
⚠️  批次 238 内存不足，跳过...
⚠️  批次 239 内存不足，跳过...
⚠️  批次 240 内存不足，跳过...
⚠️  批次 241 内存不足，跳过...
⚠️  批次 242 内存不足，跳过...
⚠️  批次 243 内存不足，跳过...
⚠️  批次 244 内存不足，跳过...
⚠️  批次 245 内存不足，跳过...
⚠️  批次 246 内存不足，跳过...
⚠️  批次 247 内存不足，跳过...
⚠️  批次 248 内存不足，跳过...
⚠️  批次 249 内存不足，跳过...
⚠️  批次 250 内存不足，跳过...
⚠️  批次 251 内存不足，跳过...
⚠️  批次 252 内存不足，跳过...
⚠️  批次 253 内存不足，跳过...
⚠️  批次 254 内存不足，跳过...
⚠️  批次 255 内存不足，跳过...
⚠️  批次 256 内存不足，跳过...
⚠️  批次 257 内存不足，跳过...
⚠️  批次 258 内存不足，跳过...
⚠️  批次 259 内存不足，跳过...
⚠️  批次 260 内存不足，跳过...
⚠️  批次 261 内存不足，跳过...
⚠️  批次 262 内存不足，跳过...
⚠️  批次 263 内存不足，跳过...
⚠️  批次 264 内存不足，跳过...
⚠️  批次 265 内存不足，跳过...
⚠️  批次 266 内存不足，跳过...
⚠️  批次 267 内存不足，跳过...
⚠️  批次 268 内存不足，跳过...
⚠️  批次 269 内存不足，跳过...
⚠️  批次 270 内存不足，跳过...
⚠️  批次 271 内存不足，跳过...
⚠️  批次 272 内存不足，跳过...
⚠️  批次 273 内存不足，跳过...
⚠️  批次 274 内存不足，跳过...
⚠️  批次 275 内存不足，跳过...
⚠️  批次 276 内存不足，跳过...
⚠️  批次 277 内存不足，跳过...
⚠️  批次 278 内存不足，跳过...
⚠️  批次 279 内存不足，跳过...
⚠️  批次 280 内存不足，跳过...
⚠️  批次 281 内存不足，跳过...
⚠️  批次 282 内存不足，跳过...
⚠️  批次 283 内存不足，跳过...
⚠️  批次 284 内存不足，跳过...
⚠️  批次 285 内存不足，跳过...
⚠️  批次 286 内存不足，跳过...
⚠️  批次 287 内存不足，跳过...
⚠️  批次 288 内存不足，跳过...
⚠️  批次 289 内存不足，跳过...
⚠️  批次 290 内存不足，跳过...
⚠️  批次 291 内存不足，跳过...
⚠️  批次 292 内存不足，跳过...
⚠️  批次 293 内存不足，跳过...
⚠️  批次 294 内存不足，跳过...
⚠️  批次 295 内存不足，跳过...
⚠️  批次 296 内存不足，跳过...
⚠️  批次 297 内存不足，跳过...
⚠️  批次 298 内存不足，跳过...
⚠️  批次 299 内存不足，跳过...
⚠️  批次 300 内存不足，跳过...
⚠️  批次 301 内存不足，跳过...
⚠️  批次 302 内存不足，跳过...
⚠️  批次 303 内存不足，跳过...
⚠️  批次 304 内存不足，跳过...
⚠️  批次 305 内存不足，跳过...
⚠️  批次 306 内存不足，跳过...
⚠️  批次 307 内存不足，跳过...
⚠️  批次 308 内存不足，跳过...
⚠️  批次 309 内存不足，跳过...
⚠️  批次 310 内存不足，跳过...
⚠️  批次 311 内存不足，跳过...
⚠️  批次 312 内存不足，跳过...
⚠️  批次 313 内存不足，跳过...
⚠️  批次 314 内存不足，跳过...
⚠️  批次 315 内存不足，跳过...
⚠️  批次 316 内存不足，跳过...
⚠️  批次 317 内存不足，跳过...
⚠️  批次 318 内存不足，跳过...
⚠️  批次 319 内存不足，跳过...
⚠️  批次 320 内存不足，跳过...
⚠️  批次 321 内存不足，跳过...
⚠️  批次 322 内存不足，跳过...
⚠️  批次 323 内存不足，跳过...
⚠️  批次 324 内存不足，跳过...
⚠️  批次 325 内存不足，跳过...
⚠️  批次 326 内存不足，跳过...
⚠️  批次 327 内存不足，跳过...
⚠️  批次 328 内存不足，跳过...
⚠️  批次 329 内存不足，跳过...
⚠️  批次 330 内存不足，跳过...
⚠️  批次 331 内存不足，跳过...
⚠️  批次 332 内存不足，跳过...
⚠️  批次 333 内存不足，跳过...
⚠️  批次 334 内存不足，跳过...
⚠️  批次 335 内存不足，跳过...
⚠️  批次 336 内存不足，跳过...
⚠️  批次 337 内存不足，跳过...
⚠️  批次 338 内存不足，跳过...
⚠️  批次 339 内存不足，跳过...
⚠️  批次 340 内存不足，跳过...
⚠️  批次 341 内存不足，跳过...
⚠️  批次 342 内存不足，跳过...
⚠️  批次 343 内存不足，跳过...
⚠️  批次 344 内存不足，跳过...
⚠️  批次 345 内存不足，跳过...
⚠️  批次 346 内存不足，跳过...
⚠️  批次 347 内存不足，跳过...
⚠️  批次 348 内存不足，跳过...
⚠️  批次 349 内存不足，跳过...
⚠️  批次 350 内存不足，跳过...
⚠️  批次 351 内存不足，跳过...
⚠️  批次 352 内存不足，跳过...
⚠️  批次 353 内存不足，跳过...
⚠️  批次 354 内存不足，跳过...
⚠️  批次 355 内存不足，跳过...
⚠️  批次 356 内存不足，跳过...
⚠️  批次 357 内存不足，跳过...
⚠️  批次 358 内存不足，跳过...
⚠️  批次 359 内存不足，跳过...
⚠️  批次 360 内存不足，跳过...
⚠️  批次 361 内存不足，跳过...
⚠️  批次 362 内存不足，跳过...
⚠️  批次 363 内存不足，跳过...
⚠️  批次 364 内存不足，跳过...
⚠️  批次 365 内存不足，跳过...
⚠️  批次 366 内存不足，跳过...
⚠️  批次 367 内存不足，跳过...
⚠️  批次 368 内存不足，跳过...
⚠️  批次 369 内存不足，跳过...
⚠️  批次 370 内存不足，跳过...
⚠️  批次 371 内存不足，跳过...
⚠️  批次 372 内存不足，跳过...
⚠️  批次 373 内存不足，跳过...
⚠️  批次 374 内存不足，跳过...
⚠️  批次 375 内存不足，跳过...
⚠️  批次 376 内存不足，跳过...
⚠️  批次 377 内存不足，跳过...
⚠️  批次 378 内存不足，跳过...
⚠️  批次 379 内存不足，跳过...
⚠️  批次 380 内存不足，跳过...
⚠️  批次 381 内存不足，跳过...
⚠️  批次 382 内存不足，跳过...
⚠️  批次 383 内存不足，跳过...
⚠️  批次 384 内存不足，跳过...
⚠️  批次 385 内存不足，跳过...
⚠️  批次 386 内存不足，跳过...
⚠️  批次 387 内存不足，跳过...
⚠️  批次 388 内存不足，跳过...
⚠️  批次 389 内存不足，跳过...
⚠️  批次 390 内存不足，跳过...
⚠️  批次 391 内存不足，跳过...
⚠️  批次 392 内存不足，跳过...
⚠️  批次 393 内存不足，跳过...
⚠️  批次 394 内存不足，跳过...
⚠️  批次 395 内存不足，跳过...
⚠️  批次 396 内存不足，跳过...
⚠️  批次 397 内存不足，跳过...
⚠️  批次 398 内存不足，跳过...
⚠️  批次 399 内存不足，跳过...
⚠️  批次 400 内存不足，跳过...
⚠️  批次 401 内存不足，跳过...
⚠️  批次 402 内存不足，跳过...
⚠️  批次 403 内存不足，跳过...
⚠️  批次 404 内存不足，跳过...
⚠️  批次 405 内存不足，跳过...
⚠️  批次 406 内存不足，跳过...
⚠️  批次 407 内存不足，跳过...
⚠️  批次 408 内存不足，跳过...
⚠️  批次 409 内存不足，跳过...
⚠️  批次 410 内存不足，跳过...
⚠️  批次 411 内存不足，跳过...
⚠️  批次 412 内存不足，跳过...
⚠️  批次 413 内存不足，跳过...
⚠️  批次 414 内存不足，跳过...
⚠️  批次 415 内存不足，跳过...
⚠️  批次 416 内存不足，跳过...
⚠️  批次 417 内存不足，跳过...
⚠️  批次 418 内存不足，跳过...
⚠️  批次 419 内存不足，跳过...
⚠️  批次 420 内存不足，跳过...
⚠️  批次 421 内存不足，跳过...
⚠️  批次 422 内存不足，跳过...
⚠️  批次 423 内存不足，跳过...
⚠️  批次 424 内存不足，跳过...
⚠️  批次 425 内存不足，跳过...
⚠️  批次 426 内存不足，跳过...
⚠️  批次 427 内存不足，跳过...
⚠️  批次 428 内存不足，跳过...
⚠️  批次 429 内存不足，跳过...
⚠️  批次 430 内存不足，跳过...
⚠️  批次 431 内存不足，跳过...
⚠️  批次 432 内存不足，跳过...
⚠️  批次 433 内存不足，跳过...
⚠️  批次 434 内存不足，跳过...
⚠️  批次 435 内存不足，跳过...
⚠️  批次 436 内存不足，跳过...
⚠️  批次 437 内存不足，跳过...
⚠️  批次 438 内存不足，跳过...
⚠️  批次 439 内存不足，跳过...
⚠️  批次 440 内存不足，跳过...
⚠️  批次 441 内存不足，跳过...
⚠️  批次 442 内存不足，跳过...
⚠️  批次 443 内存不足，跳过...
⚠️  批次 444 内存不足，跳过...
⚠️  批次 445 内存不足，跳过...
⚠️  批次 446 内存不足，跳过...
⚠️  批次 447 内存不足，跳过...
⚠️  批次 448 内存不足，跳过...
⚠️  批次 449 内存不足，跳过...
⚠️  批次 450 内存不足，跳过...
⚠️  批次 451 内存不足，跳过...
⚠️  批次 452 内存不足，跳过...
⚠️  批次 453 内存不足，跳过...
⚠️  批次 454 内存不足，跳过...
⚠️  批次 455 内存不足，跳过...
⚠️  批次 456 内存不足，跳过...
⚠️  批次 457 内存不足，跳过...
⚠️  批次 458 内存不足，跳过...
⚠️  批次 459 内存不足，跳过...
⚠️  批次 460 内存不足，跳过...
⚠️  批次 461 内存不足，跳过...
⚠️  批次 462 内存不足，跳过...
⚠️  批次 463 内存不足，跳过...
⚠️  批次 464 内存不足，跳过...
⚠️  批次 465 内存不足，跳过...
⚠️  批次 466 内存不足，跳过...
⚠️  批次 467 内存不足，跳过...
⚠️  批次 468 内存不足，跳过...
⚠️  批次 469 内存不足，跳过...
⚠️  批次 470 内存不足，跳过...
⚠️  批次 471 内存不足，跳过...
⚠️  批次 472 内存不足，跳过...
⚠️  批次 473 内存不足，跳过...
⚠️  批次 474 内存不足，跳过...
⚠️  批次 475 内存不足，跳过...
⚠️  批次 476 内存不足，跳过...
⚠️  批次 477 内存不足，跳过...
⚠️  批次 478 内存不足，跳过...
⚠️  批次 479 内存不足，跳过...
⚠️  批次 480 内存不足，跳过...
⚠️  批次 481 内存不足，跳过...
⚠️  批次 482 内存不足，跳过...
⚠️  批次 483 内存不足，跳过...
⚠️  批次 484 内存不足，跳过...
⚠️  批次 485 内存不足，跳过...
⚠️  批次 486 内存不足，跳过...
⚠️  批次 487 内存不足，跳过...
⚠️  批次 488 内存不足，跳过...
⚠️  批次 489 内存不足，跳过...
⚠️  批次 490 内存不足，跳过...
⚠️  批次 491 内存不足，跳过...
⚠️  批次 492 内存不足，跳过...
⚠️  批次 493 内存不足，跳过...
⚠️  批次 494 内存不足，跳过...
⚠️  批次 495 内存不足，跳过...
⚠️  批次 496 内存不足，跳过...
⚠️  批次 497 内存不足，跳过...
⚠️  批次 498 内存不足，跳过...
⚠️  批次 499 内存不足，跳过...
⚠️  批次 500 内存不足，跳过...
⚠️  批次 501 内存不足，跳过...
⚠️  批次 502 内存不足，跳过...
⚠️  批次 503 内存不足，跳过...
⚠️  批次 504 内存不足，跳过...
⚠️  批次 505 内存不足，跳过...
⚠️  批次 506 内存不足，跳过...
⚠️  批次 507 内存不足，跳过...
⚠️  批次 508 内存不足，跳过...
⚠️  批次 509 内存不足，跳过...
⚠️  批次 510 内存不足，跳过...
⚠️  批次 511 内存不足，跳过...
⚠️  批次 512 内存不足，跳过...
⚠️  批次 513 内存不足，跳过...
⚠️  批次 514 内存不足，跳过...
⚠️  批次 515 内存不足，跳过...
⚠️  批次 516 内存不足，跳过...
⚠️  批次 517 内存不足，跳过...
⚠️  批次 518 内存不足，跳过...
⚠️  批次 519 内存不足，跳过...
⚠️  批次 520 内存不足，跳过...
⚠️  批次 521 内存不足，跳过...
⚠️  批次 522 内存不足，跳过...
⚠️  批次 523 内存不足，跳过...
⚠️  批次 524 内存不足，跳过...
⚠️  批次 525 内存不足，跳过...
⚠️  批次 526 内存不足，跳过...
⚠️  批次 527 内存不足，跳过...
⚠️  批次 528 内存不足，跳过...
⚠️  批次 529 内存不足，跳过...
⚠️  批次 530 内存不足，跳过...
⚠️  批次 531 内存不足，跳过...
⚠️  批次 532 内存不足，跳过...
⚠️  批次 533 内存不足，跳过...
⚠️  批次 534 内存不足，跳过...
⚠️  批次 535 内存不足，跳过...
⚠️  批次 536 内存不足，跳过...
⚠️  批次 537 内存不足，跳过...
⚠️  批次 538 内存不足，跳过...
⚠️  批次 539 内存不足，跳过...
⚠️  批次 540 内存不足，跳过...
⚠️  批次 541 内存不足，跳过...
⚠️  批次 542 内存不足，跳过...
⚠️  批次 543 内存不足，跳过...
⚠️  批次 544 内存不足，跳过...
⚠️  批次 545 内存不足，跳过...
⚠️  批次 546 内存不足，跳过...
⚠️  批次 547 内存不足，跳过...
⚠️  批次 548 内存不足，跳过...
⚠️  批次 549 内存不足，跳过...
⚠️  批次 550 内存不足，跳过...
⚠️  批次 551 内存不足，跳过...
⚠️  批次 552 内存不足，跳过...
⚠️  批次 553 内存不足，跳过...
⚠️  批次 554 内存不足，跳过...
⚠️  批次 555 内存不足，跳过...
⚠️  批次 556 内存不足，跳过...
⚠️  批次 557 内存不足，跳过...
⚠️  批次 558 内存不足，跳过...
⚠️  批次 559 内存不足，跳过...
⚠️  批次 560 内存不足，跳过...
⚠️  批次 561 内存不足，跳过...
⚠️  批次 562 内存不足，跳过...
⚠️  批次 563 内存不足，跳过...
⚠️  批次 564 内存不足，跳过...
⚠️  批次 565 内存不足，跳过...
⚠️  批次 566 内存不足，跳过...
⚠️  批次 567 内存不足，跳过...
⚠️  批次 568 内存不足，跳过...
⚠️  批次 569 内存不足，跳过...
⚠️  批次 570 内存不足，跳过...
⚠️  批次 571 内存不足，跳过...
⚠️  批次 572 内存不足，跳过...
⚠️  批次 573 内存不足，跳过...
⚠️  批次 574 内存不足，跳过...
⚠️  批次 575 内存不足，跳过...
⚠️  批次 576 内存不足，跳过...
⚠️  批次 577 内存不足，跳过...
⚠️  批次 578 内存不足，跳过...
⚠️  批次 579 内存不足，跳过...
⚠️  批次 580 内存不足，跳过...
⚠️  批次 581 内存不足，跳过...
⚠️  批次 582 内存不足，跳过...
⚠️  批次 583 内存不足，跳过...
⚠️  批次 584 内存不足，跳过...
⚠️  批次 585 内存不足，跳过...
⚠️  批次 586 内存不足，跳过...
⚠️  批次 587 内存不足，跳过...
⚠️  批次 588 内存不足，跳过...
⚠️  批次 589 内存不足，跳过...
⚠️  批次 590 内存不足，跳过...
⚠️  批次 591 内存不足，跳过...
⚠️  批次 592 内存不足，跳过...
⚠️  批次 593 内存不足，跳过...
⚠️  批次 594 内存不足，跳过...
⚠️  批次 595 内存不足，跳过...
⚠️  批次 596 内存不足，跳过...
⚠️  批次 597 内存不足，跳过...
⚠️  批次 598 内存不足，跳过...
⚠️  批次 599 内存不足，跳过...
⚠️  批次 600 内存不足，跳过...
⚠️  批次 601 内存不足，跳过...
⚠️  批次 602 内存不足，跳过...
⚠️  批次 603 内存不足，跳过...
⚠️  批次 604 内存不足，跳过...
⚠️  批次 605 内存不足，跳过...
⚠️  批次 606 内存不足，跳过...
⚠️  批次 607 内存不足，跳过...
⚠️  批次 608 内存不足，跳过...
⚠️  批次 609 内存不足，跳过...
⚠️  批次 610 内存不足，跳过...
⚠️  批次 611 内存不足，跳过...
⚠️  批次 612 内存不足，跳过...
⚠️  批次 613 内存不足，跳过...
⚠️  批次 614 内存不足，跳过...
⚠️  批次 615 内存不足，跳过...
⚠️  批次 616 内存不足，跳过...
⚠️  批次 617 内存不足，跳过...
⚠️  批次 618 内存不足，跳过...
⚠️  批次 619 内存不足，跳过...
⚠️  批次 620 内存不足，跳过...
⚠️  批次 621 内存不足，跳过...
⚠️  批次 622 内存不足，跳过...
⚠️  批次 623 内存不足，跳过...
⚠️  批次 624 内存不足，跳过...
⚠️  批次 625 内存不足，跳过...
⚠️  批次 626 内存不足，跳过...
⚠️  批次 627 内存不足，跳过...
⚠️  批次 628 内存不足，跳过...
⚠️  批次 629 内存不足，跳过...
⚠️  批次 630 内存不足，跳过...
⚠️  批次 631 内存不足，跳过...
⚠️  批次 632 内存不足，跳过...
⚠️  批次 633 内存不足，跳过...
⚠️  批次 634 内存不足，跳过...
⚠️  批次 635 内存不足，跳过...
⚠️  批次 636 内存不足，跳过...
⚠️  批次 637 内存不足，跳过...
⚠️  批次 638 内存不足，跳过...
⚠️  批次 639 内存不足，跳过...
⚠️  批次 640 内存不足，跳过...
⚠️  批次 641 内存不足，跳过...
⚠️  批次 642 内存不足，跳过...
⚠️  批次 643 内存不足，跳过...
⚠️  批次 644 内存不足，跳过...
⚠️  批次 645 内存不足，跳过...
⚠️  批次 646 内存不足，跳过...
⚠️  批次 647 内存不足，跳过...
⚠️  批次 648 内存不足，跳过...
⚠️  批次 649 内存不足，跳过...
⚠️  批次 650 内存不足，跳过...
⚠️  批次 651 内存不足，跳过...
⚠️  批次 652 内存不足，跳过...
⚠️  批次 653 内存不足，跳过...
⚠️  批次 654 内存不足，跳过...
⚠️  批次 655 内存不足，跳过...
⚠️  批次 656 内存不足，跳过...
⚠️  批次 657 内存不足，跳过...
⚠️  批次 658 内存不足，跳过...
⚠️  批次 659 内存不足，跳过...
⚠️  批次 660 内存不足，跳过...
⚠️  批次 661 内存不足，跳过...
⚠️  批次 662 内存不足，跳过...
⚠️  批次 663 内存不足，跳过...
⚠️  批次 664 内存不足，跳过...
⚠️  批次 665 内存不足，跳过...
⚠️  批次 666 内存不足，跳过...
⚠️  批次 667 内存不足，跳过...
⚠️  批次 668 内存不足，跳过...
⚠️  批次 669 内存不足，跳过...
⚠️  批次 670 内存不足，跳过...
⚠️  批次 671 内存不足，跳过...
⚠️  批次 672 内存不足，跳过...
⚠️  批次 673 内存不足，跳过...
⚠️  批次 674 内存不足，跳过...
⚠️  批次 675 内存不足，跳过...
⚠️  批次 676 内存不足，跳过...
⚠️  批次 677 内存不足，跳过...
⚠️  批次 678 内存不足，跳过...
⚠️  批次 679 内存不足，跳过...
⚠️  批次 680 内存不足，跳过...
⚠️  批次 681 内存不足，跳过...
⚠️  批次 682 内存不足，跳过...
⚠️  批次 683 内存不足，跳过...
⚠️  批次 684 内存不足，跳过...
⚠️  批次 685 内存不足，跳过...
⚠️  批次 686 内存不足，跳过...
⚠️  批次 687 内存不足，跳过...
⚠️  批次 688 内存不足，跳过...
⚠️  批次 689 内存不足，跳过...
⚠️  批次 690 内存不足，跳过...
⚠️  批次 691 内存不足，跳过...
⚠️  批次 692 内存不足，跳过...
⚠️  批次 693 内存不足，跳过...
⚠️  批次 694 内存不足，跳过...
⚠️  批次 695 内存不足，跳过...
⚠️  批次 696 内存不足，跳过...
⚠️  批次 697 内存不足，跳过...
⚠️  批次 698 内存不足，跳过...
⚠️  批次 699 内存不足，跳过...
⚠️  批次 700 内存不足，跳过...
⚠️  批次 701 内存不足，跳过...
⚠️  批次 702 内存不足，跳过...
⚠️  批次 703 内存不足，跳过...
⚠️  批次 704 内存不足，跳过...
⚠️  批次 705 内存不足，跳过...
⚠️  批次 706 内存不足，跳过...
⚠️  批次 707 内存不足，跳过...
⚠️  批次 708 内存不足，跳过...
⚠️  批次 709 内存不足，跳过...
⚠️  批次 710 内存不足，跳过...
⚠️  批次 711 内存不足，跳过...
⚠️  批次 712 内存不足，跳过...
⚠️  批次 713 内存不足，跳过...
⚠️  批次 714 内存不足，跳过...
⚠️  批次 715 内存不足，跳过...
⚠️  批次 716 内存不足，跳过...
⚠️  批次 717 内存不足，跳过...
⚠️  批次 718 内存不足，跳过...
⚠️  批次 719 内存不足，跳过...
⚠️  批次 720 内存不足，跳过...
⚠️  批次 721 内存不足，跳过...
⚠️  批次 722 内存不足，跳过...
⚠️  批次 723 内存不足，跳过...
⚠️  批次 724 内存不足，跳过...
⚠️  批次 725 内存不足，跳过...
⚠️  批次 726 内存不足，跳过...
⚠️  批次 727 内存不足，跳过...
⚠️  批次 728 内存不足，跳过...
⚠️  批次 729 内存不足，跳过...
⚠️  批次 730 内存不足，跳过...
⚠️  批次 731 内存不足，跳过...
⚠️  批次 732 内存不足，跳过...
⚠️  批次 733 内存不足，跳过...
⚠️  批次 734 内存不足，跳过...
⚠️  批次 735 内存不足，跳过...
⚠️  批次 736 内存不足，跳过...
⚠️  批次 737 内存不足，跳过...
⚠️  批次 738 内存不足，跳过...
⚠️  批次 739 内存不足，跳过...
⚠️  批次 740 内存不足，跳过...
⚠️  批次 741 内存不足，跳过...
⚠️  批次 742 内存不足，跳过...
⚠️  批次 743 内存不足，跳过...
⚠️  批次 744 内存不足，跳过...
⚠️  批次 745 内存不足，跳过...
⚠️  批次 746 内存不足，跳过...
⚠️  批次 747 内存不足，跳过...
⚠️  批次 748 内存不足，跳过...
⚠️  批次 749 内存不足，跳过...
⚠️  批次 750 内存不足，跳过...
⚠️  批次 751 内存不足，跳过...
⚠️  批次 752 内存不足，跳过...
⚠️  批次 753 内存不足，跳过...
⚠️  批次 754 内存不足，跳过...
⚠️  批次 755 内存不足，跳过...
⚠️  批次 756 内存不足，跳过...
⚠️  批次 757 内存不足，跳过...
⚠️  批次 758 内存不足，跳过...
⚠️  批次 759 内存不足，跳过...
⚠️  批次 760 内存不足，跳过...
⚠️  批次 761 内存不足，跳过...
⚠️  批次 762 内存不足，跳过...
⚠️  批次 763 内存不足，跳过...
⚠️  批次 764 内存不足，跳过...
⚠️  批次 765 内存不足，跳过...
⚠️  批次 766 内存不足，跳过...
⚠️  批次 767 内存不足，跳过...
⚠️  批次 768 内存不足，跳过...
⚠️  批次 769 内存不足，跳过...
⚠️  批次 770 内存不足，跳过...
⚠️  批次 771 内存不足，跳过...
⚠️  批次 772 内存不足，跳过...
⚠️  批次 773 内存不足，跳过...
⚠️  批次 774 内存不足，跳过...
⚠️  批次 775 内存不足，跳过...
⚠️  批次 776 内存不足，跳过...
⚠️  批次 777 内存不足，跳过...
⚠️  批次 778 内存不足，跳过...
⚠️  批次 779 内存不足，跳过...
⚠️  批次 780 内存不足，跳过...
⚠️  批次 781 内存不足，跳过...
⚠️  批次 782 内存不足，跳过...
⚠️  批次 783 内存不足，跳过...
⚠️  批次 784 内存不足，跳过...
⚠️  批次 785 内存不足，跳过...
⚠️  批次 786 内存不足，跳过...
⚠️  批次 787 内存不足，跳过...
⚠️  批次 788 内存不足，跳过...
⚠️  批次 789 内存不足，跳过...
⚠️  批次 790 内存不足，跳过...
⚠️  批次 791 内存不足，跳过...
⚠️  批次 792 内存不足，跳过...
⚠️  批次 793 内存不足，跳过...
⚠️  批次 794 内存不足，跳过...
⚠️  批次 795 内存不足，跳过...
⚠️  批次 796 内存不足，跳过...
⚠️  批次 797 内存不足，跳过...
⚠️  批次 798 内存不足，跳过...
⚠️  批次 799 内存不足，跳过...
⚠️  批次 800 内存不足，跳过...
⚠️  批次 801 内存不足，跳过...
⚠️  批次 802 内存不足，跳过...
⚠️  批次 803 内存不足，跳过...
⚠️  批次 804 内存不足，跳过...
⚠️  批次 805 内存不足，跳过...
⚠️  批次 806 内存不足，跳过...
⚠️  批次 807 内存不足，跳过...
⚠️  批次 808 内存不足，跳过...
⚠️  批次 809 内存不足，跳过...
⚠️  批次 810 内存不足，跳过...
⚠️  批次 811 内存不足，跳过...
⚠️  批次 812 内存不足，跳过...
⚠️  批次 813 内存不足，跳过...
⚠️  批次 814 内存不足，跳过...
⚠️  批次 815 内存不足，跳过...
⚠️  批次 816 内存不足，跳过...
⚠️  批次 817 内存不足，跳过...
⚠️  批次 818 内存不足，跳过...
⚠️  批次 819 内存不足，跳过...
⚠️  批次 820 内存不足，跳过...
⚠️  批次 821 内存不足，跳过...
⚠️  批次 822 内存不足，跳过...
⚠️  批次 823 内存不足，跳过...
⚠️  批次 824 内存不足，跳过...
⚠️  批次 825 内存不足，跳过...
⚠️  批次 826 内存不足，跳过...
⚠️  批次 827 内存不足，跳过...
⚠️  批次 828 内存不足，跳过...
⚠️  批次 829 内存不足，跳过...
⚠️  批次 830 内存不足，跳过...
⚠️  批次 831 内存不足，跳过...
⚠️  批次 832 内存不足，跳过...
⚠️  批次 833 内存不足，跳过...
⚠️  批次 834 内存不足，跳过...
⚠️  批次 835 内存不足，跳过...
⚠️  批次 836 内存不足，跳过...
⚠️  批次 837 内存不足，跳过...
⚠️  批次 838 内存不足，跳过...
⚠️  批次 839 内存不足，跳过...
⚠️  批次 840 内存不足，跳过...
⚠️  批次 841 内存不足，跳过...
⚠️  批次 842 内存不足，跳过...
⚠️  批次 843 内存不足，跳过...
⚠️  批次 844 内存不足，跳过...
⚠️  批次 845 内存不足，跳过...
⚠️  批次 846 内存不足，跳过...
⚠️  批次 847 内存不足，跳过...
⚠️  批次 848 内存不足，跳过...
⚠️  批次 849 内存不足，跳过...
⚠️  批次 850 内存不足，跳过...
⚠️  批次 851 内存不足，跳过...
⚠️  批次 852 内存不足，跳过...
⚠️  批次 853 内存不足，跳过...
⚠️  批次 854 内存不足，跳过...
⚠️  批次 855 内存不足，跳过...
⚠️  批次 856 内存不足，跳过...
⚠️  批次 857 内存不足，跳过...
⚠️  批次 858 内存不足，跳过...
⚠️  批次 859 内存不足，跳过...
⚠️  批次 860 内存不足，跳过...
⚠️  批次 861 内存不足，跳过...
⚠️  批次 862 内存不足，跳过...
⚠️  批次 863 内存不足，跳过...
⚠️  批次 864 内存不足，跳过...
⚠️  批次 865 内存不足，跳过...
⚠️  批次 866 内存不足，跳过...
⚠️  批次 867 内存不足，跳过...
⚠️  批次 868 内存不足，跳过...
⚠️  批次 869 内存不足，跳过...
⚠️  批次 870 内存不足，跳过...
⚠️  批次 871 内存不足，跳过...
⚠️  批次 872 内存不足，跳过...
⚠️  批次 873 内存不足，跳过...
⚠️  批次 874 内存不足，跳过...
⚠️  批次 875 内存不足，跳过...
⚠️  批次 876 内存不足，跳过...
⚠️  批次 877 内存不足，跳过...
⚠️  批次 878 内存不足，跳过...
⚠️  批次 879 内存不足，跳过...
⚠️  批次 880 内存不足，跳过...
⚠️  批次 881 内存不足，跳过...
⚠️  批次 882 内存不足，跳过...
⚠️  批次 883 内存不足，跳过...
⚠️  批次 884 内存不足，跳过...
⚠️  批次 885 内存不足，跳过...
⚠️  批次 886 内存不足，跳过...
⚠️  批次 887 内存不足，跳过...
⚠️  批次 888 内存不足，跳过...
⚠️  批次 889 内存不足，跳过...
⚠️  批次 890 内存不足，跳过...
⚠️  批次 891 内存不足，跳过...
⚠️  批次 892 内存不足，跳过...
⚠️  批次 893 内存不足，跳过...
⚠️  批次 894 内存不足，跳过...
⚠️  批次 895 内存不足，跳过...
⚠️  批次 896 内存不足，跳过...
⚠️  批次 897 内存不足，跳过...
⚠️  批次 898 内存不足，跳过...
⚠️  批次 899 内存不足，跳过...
⚠️  批次 900 内存不足，跳过...
⚠️  批次 901 内存不足，跳过...
⚠️  批次 902 内存不足，跳过...
⚠️  批次 903 内存不足，跳过...
✓ 新的最佳模型已保存！ (Epoch 1)
Epoch [1/5],Train Loss: 0.1336 🏆
Epoch 2/5:   3%|██▏                                                                    | 28/904 [00:03<00:56, 15.46it/s]
当前学习率: 0.000905
⚠️  批次 0 检测到 NaN/Inf 损失，跳过此批次...
损失详情: {'total_loss_f': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'pixel_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'gradient_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'perceptual_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>), 'total_loss_vi': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'rec_i': tensor(nan, device='cuda:2', grad_fn=<MseLossBackward0>), 'rec_g': tensor(nan, device='cuda:2', grad_fn=<MseLossBackward0>), 'kl_loss_i': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'kl_loss_g': tensor(nan, device='cuda:2', grad_fn=<MulBackward0>), 'total_loss': tensor(nan, device='cuda:2', grad_fn=<AddBackward0>)}
⚠️  批次 1 内存不足，跳过...
⚠️  批次 2 内存不足，跳过...
⚠️  批次 3 内存不足，跳过...
⚠️  批次 4 内存不足，跳过...
⚠️  批次 5 内存不足，跳过...
⚠️  批次 6 内存不足，跳过...
⚠️  批次 7 内存不足，跳过...
⚠️  批次 8 内存不足，跳过...
⚠️  批次 9 内存不足，跳过...
⚠️  批次 10 内存不足，跳过...
⚠️  批次 11 内存不足，跳过...
⚠️  批次 12 内存不足，跳过...
⚠️  批次 13 内存不足，跳过...
⚠️  批次 14 内存不足，跳过...
⚠️  批次 15 内存不足，跳过...
⚠️  批次 16 内存不足，跳过...
⚠️  批次 17 内存不足，跳过...
⚠️  批次 18 内存不足，跳过...
⚠️  批次 19 内存不足，跳过...
⚠️  批次 20 内存不足，跳过...
⚠️  批次 21 内存不足，跳过...
⚠️  批次 22 内存不足，跳过...
⚠️  批次 23 内存不足，跳过...
⚠️  批次 24 内存不足，跳过...
⚠️  批次 25 内存不足，跳过...
⚠️  批次 26 内存不足，跳过...
⚠️  批次 27 内存不足，跳过...
⚠️  批次 28 内存不足，跳过...
⚠️  批次 29 内存不足，跳过...
⚠️  批次 30 内存不足，跳过...
⚠️  批次 31 内存不足，跳过...
⚠️  批次 32 内存不足，跳过...
⚠️  批次 33 内存不足，跳过...
⚠️  批次 34 内存不足，跳过...
⚠️  批次 35 内存不足，跳过...
⚠️  批次 36 内存不足，跳过...
⚠️  批次 37 内存不足，跳过...
⚠️  批次 38 内存不足，跳过...
⚠️  批次 39 内存不足，跳过...
⚠️  批次 40 内存不足，跳过...
⚠️  批次 41 内存不足，跳过...
⚠️  批次 42 内存不足，跳过...
⚠️  批次 43 内存不足，跳过...
⚠️  批次 44 内存不足，跳过...
⚠️  批次 45 内存不足，跳过...
⚠️  批次 46 内存不足，跳过...
⚠️  批次 47 内存不足，跳过...
⚠️  批次 48 内存不足，跳过...
⚠️  批次 49 内存不足，跳过...
⚠️  批次 50 内存不足，跳过...
⚠️  批次 51 内存不足，跳过...
Traceback (most recent call last):
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 421, in <module>
    main(**config_dic)
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 384, in main
    best_epoch, best_loss = train_model(
                            ^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 138, in train_model
    epoch_loss = train_epoch_model(model, train_loader, criterion, optimizer, device_1, device_2, device_3, val_loader, pbar)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/train.py", line 39, in train_epoch_model
    output, l, g, mu_l, sigma2_l, mu_g, sigma2_g = model(i_image, v_image, device_1, device_2, device_3)
                                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/model.py", line 43, in forward
    l,mu_l,sigma2_l = self.I_encoder_decoder(i)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/model.py", line 17, in forward
    x=self.encoder(x)
      ^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/component.py", line 19, in forward
    x=self.model(x)
      ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/../restormer/restormer_arch.py", line 251, in forward
    latent = self.latent(inp_enc_level4)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/../restormer/restormer_arch.py", line 141, in forward
    x = x + self.attn(self.norm1(x))
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/1024_whs/IVfusion_method1/model/stage2/../restormer/restormer_arch.py", line 112, in forward
    k = rearrange(k, 'b (head c) h w -> b head c (h w)', head=self.num_heads)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/.local/lib/python3.11/site-packages/einops/einops.py", line 600, in rearrange
    return reduce(tensor, pattern, reduction="rearrange", **axes_lengths)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/.local/lib/python3.11/site-packages/einops/einops.py", line 532, in reduce
    return _apply_recipe(
           ^^^^^^^^^^^^^^
  File "/home/user/.local/lib/python3.11/site-packages/einops/einops.py", line 243, in _apply_recipe
    tensor = backend.reshape(tensor, init_shapes)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/user/.local/lib/python3.11/site-packages/einops/_backends.py", line 93, in reshape
    return x.reshape(shape)
           ^^^^^^^^^^^^^^^^
KeyboardInterrupt
